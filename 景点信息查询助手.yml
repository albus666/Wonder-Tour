app:
  description: ç”¨äºå¤„ç†ç”¨æˆ·è¯¢é—®æ™¯ç‚¹ä»¥åŠç›¸å…³å†…å®¹
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: æ™¯ç‚¹ä¿¡æ¯æŸ¥è¯¢åŠ©æ‰‹
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.0.14@d333909fe8d75a335b44da4b878d5120779b8703f12c21cf4730135d6864afbb
kind: app
version: 0.1.5
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: template-transform
        targetType: llm
      id: 1742648640620-source-1742648540194-target
      source: '1742648640620'
      sourceHandle: source
      target: '1742648540194'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: end
      id: 1742648540194-source-1742647437324-target
      source: '1742648540194'
      sourceHandle: source
      target: '1742647437324'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: end
      id: 17427422601360-source-1742742270034-target
      source: '17427422601360'
      sourceHandle: source
      target: '1742742270034'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1742745909032'
        sourceType: iteration-start
        targetType: code
      id: 1742745909032start-source-1742745922568-target
      source: 1742745909032start
      sourceHandle: source
      target: '1742745922568'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInLoop: false
        sourceType: iteration
        targetType: template-transform
      id: 1742745909032-source-1742745468189-target
      source: '1742745909032'
      sourceHandle: source
      target: '1742745468189'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: template-transform
        targetType: end
      id: 1742745468189-source-1742745417323-target
      source: '1742745468189'
      sourceHandle: source
      target: '1742745417323'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1742895657263-fail-branch-17427422601360-target
      selected: false
      source: '1742895657263'
      sourceHandle: fail-branch
      target: '17427422601360'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: question-classifier
      id: 1742642596090-source-1742971822317-target
      source: '1742642596090'
      sourceHandle: source
      target: '1742971822317'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: question-classifier
        targetType: llm
      id: 1742971822317-2-17427422601360-target
      selected: false
      source: '1742971822317'
      sourceHandle: '2'
      target: '17427422601360'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: question-classifier
        targetType: code
      id: 1742971822317-1-1742895657263-target
      source: '1742971822317'
      sourceHandle: '1'
      target: '1742895657263'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: http-request
      id: 1742895657263-source-1742969896689-target
      source: '1742895657263'
      sourceHandle: source
      target: '1742969896689'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: http-request
        targetType: if-else
      id: 1742969896689-source-1742743085244-target
      source: '1742969896689'
      sourceHandle: source
      target: '1742743085244'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: iteration
      id: 1742743085244-true-1742745909032-target
      source: '1742743085244'
      sourceHandle: 'true'
      target: '1742745909032'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1742743085244-false-17427422601360-target
      source: '1742743085244'
      sourceHandle: 'false'
      target: '17427422601360'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: http-request
        targetType: llm
      id: 1742969896689-fail-branch-17427422601360-target
      source: '1742969896689'
      sourceHandle: fail-branch
      target: '17427422601360'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        sourceType: iteration-start
        targetType: code
      id: 1743145179759start-source-1743145201728-target
      source: 1743145179759start
      sourceHandle: source
      target: '1743145201728'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: iteration
      id: 1742743085244-a3b9a45f-119e-48f3-86f8-1ad0fba1bde7-1743145179759-target
      source: '1742743085244'
      sourceHandle: a3b9a45f-119e-48f3-86f8-1ad0fba1bde7
      target: '1743145179759'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        sourceType: code
        targetType: code
      id: 1743145201728-source-1743145790208-target
      source: '1743145201728'
      sourceHandle: source
      target: '1743145790208'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        sourceType: code
        targetType: code
      id: 1743145201728-source-1743145890624-target
      source: '1743145201728'
      sourceHandle: source
      target: '1743145890624'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInLoop: false
        sourceType: iteration
        targetType: template-transform
      id: 1743145179759-source-1742648640620-target
      source: '1743145179759'
      sourceHandle: source
      target: '1742648640620'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        sourceType: code
        targetType: template-transform
      id: 1743145790208-source-1743146801950-target
      source: '1743145790208'
      sourceHandle: source
      target: '1743146801950'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        sourceType: code
        targetType: template-transform
      id: 1743145890624-source-1743146801950-target
      source: '1743145890624'
      sourceHandle: source
      target: '1743146801950'
      targetHandle: target
      type: custom
      zIndex: 1002
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: ç”¨æˆ·è¾“å…¥
          max_length: 100
          options: []
          required: true
          type: paragraph
          variable: input
      height: 89
      id: '1742642596090'
      position:
        x: 30
        y: 285.5
      positionAbsolute:
        x: 30
        y: 285.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1742648540194'
          - text
          variable: output
        selected: false
        title: ç»“æŸ
        type: end
      height: 89
      id: '1742647437324'
      position:
        x: 3214
        y: 887.5
      positionAbsolute:
        x: 3214
        y: 887.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1742648640620'
          - output
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: deepseek-r1
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: 74511e79-9bf2-441c-aff6-e19f68f53302
          role: system
          text: '{{#context#}}æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œä»¥åŠ{{#1742969896689.body#}}é—®é¢˜ç±»åˆ«ï¼Œåˆ†æè¯„è®º'
        - id: fa16faa2-774c-47cc-bf80-453e9932a590
          role: user
          text: '{{#context#}}æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œä»¥åŠ{{#1742969896689.body#}}é—®é¢˜ç±»åˆ«ï¼Œåˆ†æè¯„è®º

            '
        - id: 94e89314-2368-455b-b357-28e37ab5d6cf
          role: assistant
          text: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 1000
        selected: true
        title: æ™¯åŒºä¿¡æ¯åˆ†æ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 115
      id: '1742648540194'
      position:
        x: 2910
        y: 874.5
      positionAbsolute:
        x: 2910
        y: 874.5
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: '{{ info }}'
        title: æ¨¡æ¿è½¬æ¢
        type: template-transform
        variables:
        - value_selector:
          - '1743145179759'
          - output
          variable: info
      height: 53
      id: '1742648640620'
      position:
        x: 2606
        y: 887.5
      positionAbsolute:
        x: 2606
        y: 887.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1742642596090'
          - input
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: deepseek-v3
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - edition_type: basic
          id: 5900c04b-26e1-4b40-80f3-4b364c668c78
          role: system
          text: '{{#context#}}

            # è§’è‰²

            ä½ æ˜¯æ—…æ¸¸å°åŠ©æ‰‹ï¼Œåªæä¾›æ—…æ¸¸ç›¸å…³çš„å†…å®¹ï¼Œä¸æ¶‰åŠç”Ÿæ´»çš„æ–¹é¢ï¼Œå¦‚å¤©æ°”æ¸©åº¦ç­‰å†…å®¹


            # è§„åˆ™

            æ ¹æ®ç”¨æˆ·è¾“å…¥ï¼Œå½“ç”¨æˆ·è¾“å…¥çš„å†…å®¹ä¸æ—…æ¸¸åŠ©æ‰‹åŠŸèƒ½æ— å…³æ—¶ï¼Œéœ€å‘ç”¨æˆ·å‘å‡ºæç¤ºï¼Œå¹¶å¯¹å…¶è¾“å…¥å†…å®¹è¿›è¡Œç®€è¦åˆ†æåç”Ÿæˆå›å¤ã€‚

            æˆ–è€…å¦‚æœæ˜¯å› ä¸ºè¾“å…¥åªæ˜¯ç®€å•çš„è¯¢é—®ï¼Œå¯ä»¥æé†’ç”¨æˆ·å¯ä»¥è¾“å…¥å¤§æ¦‚ç›®æ ‡ä»¥ä¾¿è¿›è¡Œåˆ†æ'
        selected: false
        title: é”™è¯¯ä¿¡æ¯åˆ†æ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '17427422601360'
      position:
        x: 1926
        y: 689.5
      positionAbsolute:
        x: 1926
        y: 689.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '17427422601360'
          - text
          variable: text
        selected: false
        title: æ„å¤–é€€å‡º
        type: end
      height: 89
      id: '1742742270034'
      position:
        x: 2606
        y: 642.5
      positionAbsolute:
        x: 2606
        y: 642.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: not empty
            id: ac278538-6423-4406-a363-0472ee48840e
            value: ''
            varType: array[string]
            variable_selector:
            - '1742895657263'
            - keywords
          - comparison_operator: is
            id: f7f99427-5359-446c-8347-3bdb8bcea01c
            value: '"æ™¯ç‚¹æ¨è"'
            varType: string
            variable_selector:
            - '1742969896689'
            - body
          id: 'true'
          logical_operator: and
        - case_id: a3b9a45f-119e-48f3-86f8-1ad0fba1bde7
          conditions:
          - comparison_operator: not empty
            id: 6803632d-a05a-48f0-b894-c3dd4cdd3ee0
            value: ''
            varType: array[string]
            variable_selector:
            - '1742895657263'
            - keywords
          - comparison_operator: is not
            id: 3b956632-0e48-49f1-abd0-c865d53da98e
            value: '"æ™¯ç‚¹æ¨è"'
            varType: string
            variable_selector:
            - '1742969896689'
            - body
          id: a3b9a45f-119e-48f3-86f8-1ad0fba1bde7
          logical_operator: and
        desc: ''
        selected: false
        title: å·¥ä½œåˆ†æµ
        type: if-else
      height: 225
      id: '1742743085244'
      position:
        x: 1246
        y: 502.5
      positionAbsolute:
        x: 1246
        y: 502.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1742745468189'
          - output
          variable: text
        selected: false
        title: æ™¯ç‚¹æ¨è
        type: end
      height: 89
      id: '1742745417323'
      position:
        x: 2910
        y: 502.5
      positionAbsolute:
        x: 2910
        y: 502.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: "{# ================== å¾ªç¯ä½“ ================== #}\r\n{% macro attraction_card(card)\
          \ -%}\r\n## {{ card.poiName }}\r\n{% if card.zoneName %}### åŒºåŸŸï¼š{{ card.zoneName\
          \ }}{% endif %}\r\n{% if card.sightLevelStr %}\U0001F3C5 ç­‰çº§ï¼š{{ card.sightLevelStr\
          \ }}{% endif %}\r\nâ­ è¯„åˆ†ï¼š{{ card.commentScore }}ï¼ˆåŸºäº{{ card.commentCount }}æ¡è¯„ä»·ï¼‰\r\
          \n\r\n{# --------------------- æ ‡ç­¾ä¿¡æ¯ --------------------- #}\r\n{% if card.tagNameList\
          \ or card.otherTagList %}\r\n### æ ‡ç­¾åˆ†ç±»ï¼š\r\n  \U0001F3F7ï¸ ä¸»æ ‡ç­¾ï¼š{{ card.tagNameList\
          \ | join('ã€') }}\r\n  \U0001F3F7ï¸ æœåŠ¡æ ‡ç­¾ï¼š{% for tag in card.otherTagList %}{{\
          \ tag.name }}{% if not loop.last %} | {% endif %}{% endfor %}\r\n{% endif\
          \ %}\r\n\r\n{# --------------------- ä»·æ ¼ä¿¡æ¯ --------------------- #}\r\n###\
          \ é—¨ç¥¨ä»·æ ¼ï¼š\r\n{% if card.isFree %}\r\n   \U0001F193 å…è´¹å¼€æ”¾ï¼ˆ{{ card.priceTypeDesc\
          \ }}ï¼‰\r\n{% else %}\r\n{% if card.priceType|default('') == '' or card.price|default('')\
          \ == '' %}\r\n  æœªçŸ¥\r\n{% else %}\r\n{% if card.price == card.marketPrice\
          \ or card.preferentialPrice == 0 %}\r\n  \U0001F4B5  Â¥{{ card.marketPrice\
          \ }}\r\n{% else %}\r\n  \U0001F4B5  ~~Â¥{{ card.marketPrice }}~~ â” Â¥{{ card.price\
          \ }}ï¼ˆ{{ card.preferentialDesc }}ï¼‰\r\n{% endif %}\r\n{% endif %}\r\n{% endif\
          \ %}\r\n\r\n\r\n{# --------------------- æ‰©å±•ä¿¡æ¯ --------------------- #}\r\
          \n{% if card.shortFeatures %}\r\n### ç‰¹è‰²äº®ç‚¹ï¼š\r\n  {% for feat in card.shortFeatures\
          \ %}\r\n  â–¶ {{ feat }}{% if not loop.last %}\\n    {% endif %}{% endfor\
          \ %}\r\n{% endif %}\r\n### æ’è¡Œæ¦œï¼š{{ card.sightCategoryInfo | default(\"æœªä¸Šæ¦œ\"\
          ) }}\r\n\r\n{%- endmacro %}\r\n\r\n{# ===================== ä¸»å¾ªç¯ =====================\
          \ #}\r\n{% for item in attractionList %}\r\n{{ attraction_card(item.card)\
          \ }}\r\n{% if not loop.last %}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{% endif %}\r\
          \n{% endfor %}"
        title: æ¨¡æ¿è½¬æ¢
        type: template-transform
        variables:
        - value_selector:
          - '1742745909032'
          - output
          variable: attractionList
      height: 53
      id: '1742745468189'
      position:
        x: 2606
        y: 502.5
      positionAbsolute:
        x: 2606
        y: 502.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        error_handle_mode: continue-on-error
        is_parallel: false
        iterator_selector:
        - '1742895657263'
        - keywords
        output_selector:
        - '1742745922568'
        - attractionList
        output_type: array[object]
        parallel_nums: 10
        selected: false
        start_node_id: 1742745909032start
        title: æ—…æ¸¸æ¨è
        type: iteration
        width: 388
      height: 147
      id: '1742745909032'
      position:
        x: 1854
        y: 502.5
      positionAbsolute:
        x: 1854
        y: 502.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 388
      zIndex: 1
    - data:
        desc: ''
        isInIteration: true
        selected: false
        title: ''
        type: iteration-start
      draggable: false
      height: 48
      id: 1742745909032start
      parentId: '1742745909032'
      position:
        x: 24
        y: 68
      positionAbsolute:
        x: 1878
        y: 570.5
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-iteration-start
      width: 44
      zIndex: 1002
    - data:
        code: "import requests\n\n\ndef get_district_id(cityName: str):\n    url =\
          \ \"https://m.ctrip.com/restapi/soa2/30668/search\"\n\n    querystring =\
          \ {\n        \"action\": \"online\",\n        \"source\": \"globalonline\"\
          ,\n        \"keyword\": cityName\n    }\n\n    payload = \"\"\n    headers\
          \ = {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n\
          \        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\
          \ (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 Edg/134.0.0.0\",\n\
          \        \"Accept\": \"*/*\",\n        \"Accept-Encoding\": \"gzip, deflate,\
          \ br\",\n        \"Connection\": \"keep-alive\",\n        \"Cookie\": \"\
          GUID=09031022317999445208\",\n        \"Host\": \"m.ctrip.com\",\n     \
          \   \"Content-Length\": \"0\"\n    }\n\n    response = requests.request(\"\
          POST\", url, data=payload, headers=headers, params=querystring)\n\n    try:\n\
          \        response.raise_for_status()\n    except requests.exceptions.HTTPError\
          \ as e:\n        return e\n\n    result = response.json()\n\n    # print(result['data'][0])\n\
          \    districtId = result['data'][0]['id']\n\n    return districtId\n\n\n\
          def main(cityName: str):\n    districtId = int(get_district_id(cityName))\n\
          \    url = \"https://m.ctrip.com/restapi/soa2/18109/json/getAttractionList\"\
          \n\n    querystring = {\"_fxpcqlniredt\": \"09031162419158778138\", \"x-traceID\"\
          : \"09031162419158778138-1742713344797-6843463\"}\n\n    payload = {\n \
          \       \"head\": {\n            \"cid\": \"09031162419158778138\",\n  \
          \          \"ctok\": \"\",\n            \"cver\": \"1.0\",\n           \
          \ \"lang\": \"01\",\n            \"sid\": \"8888\",\n            \"syscode\"\
          : \"999\",\n            \"auth\": \"\",\n            \"xsid\": \"\",\n \
          \           \"extension\": []\n        },\n        \"scene\": \"online\"\
          ,\n        \"districtId\": districtId,\n        \"index\": 1,\n        \"\
          sortType\": 1,\n        \"count\": 10,\n        \"filter\": {},\n      \
          \  \"returnModuleType\": \"all\"\n    }\n    headers = {\n        \"Content-Type\"\
          : \"application/json\",\n        \"Cookie\": \"GUID=09031136319238214458\"\
          ,\n        \"Cookieorigin\": \"https://you.ctrip.com\",\n        \"Accept\"\
          : \"*/*\",\n        \"Accept-Encoding\": \"gzip, deflate, br, zstd\",\n\
          \        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\
          \ (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 Edg/134.0.0.0\",\n\
          \        \"Connection\": \"keep-alive\"\n    }\n\n    response = requests.request(\"\
          POST\", url, json=payload, headers=headers, params=querystring)\n    attractionList\
          \ = response.json()[\"attractionList\"]\n    return {'attractionList': attractionList}\n"
        code_language: python3
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1742745909032'
        outputs:
          attractionList:
            children: null
            type: array[object]
        selected: false
        title: ä¿¡æ¯æ£€ç´¢
        type: code
        variables:
        - value_selector:
          - '1742745909032'
          - item
          variable: cityName
      height: 53
      id: '1742745922568'
      parentId: '1742745909032'
      position:
        x: 124.26906901444522
        y: 68
      positionAbsolute:
        x: 1978.2690690144452
        y: 570.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "import requests\n\n\ndef main(text: str):\n    url = \"http://www.atopes.xyz:4399/get_keyword\"\
          \n\n    querystring = {\n        \"text\": text\n    }\n\n    payload =\
          \ \"\"\n    headers = {\n        \"Accept\": \"*/*\",\n        \"Accept-Encoding\"\
          : \"gzip, deflate, br\",\n        \"User-Agent\": \"PostmanRuntime-ApipostRuntime/1.1.0\"\
          ,\n        \"Connection\": \"keep-alive\",\n        \"Content-Type\": \"\
          application/json;charset=UTF-8\",\n    }\n\n    response = requests.request(\"\
          GET\", url, data=payload, headers=headers, params=querystring)\n\n    keywords\
          \ = response.json()\n\n    return {\n        'keywords': keywords\n    }\n"
        code_language: python3
        desc: ''
        error_strategy: fail-branch
        outputs:
          keywords:
            children: null
            type: array[string]
        selected: false
        title: åœ°ç‚¹æå–
        type: code
        variables:
        - value_selector:
          - '1742642596090'
          - input
          variable: text
      height: 89
      id: '1742895657263'
      position:
        x: 638
        y: 360
      positionAbsolute:
        x: 638
        y: 360
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data: []
          type: none
        desc: ''
        error_strategy: fail-branch
        headers: ''
        method: get
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: å…·ä½“æ„å›¾åˆ†ç±»
        type: http-request
        url: http://www.atopes.xyz:4399/classify?text={{#1742642596090.input#}}
        variables: []
      height: 190
      id: '1742969896689'
      position:
        x: 940.7563563381484
        y: 502.5
      positionAbsolute:
        x: 940.7563563381484
        y: 502.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        classes:
        - id: '1'
          name: æ™¯ç‚¹æ—…æ¸¸ç›¸å…³
        - id: '2'
          name: æ™¯ç‚¹æ—…æ¸¸æ— å…³
        desc: ''
        instruction: '# è§’è‰²(Role)

          ä½ æ˜¯ä¸€åä¿¡æ¯åˆ†ç±»ä¸“å®¶ï¼Œæ“…é•¿å‡†ç¡®åˆ¤æ–­ç”¨æˆ·è¾“å…¥ä¿¡æ¯ä¸æ™¯ç‚¹ä¹‹é—´çš„å…³è”ï¼Œæ€§æ ¼æ²‰ç¨³ã€è®¤çœŸè´Ÿè´£ï¼Œä¸“æ³¨äºåˆ†ææ¯ä¸€ä¸ªè¾“å…¥å†…å®¹ã€‚


          # åŠŸèƒ½(Skills)

          ## åŠŸèƒ½1(Skill 1)ï¼šæ„å›¾åŒºåˆ†

          - å‡†ç¡®åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ˜¯ä¸æ™¯ç‚¹ç›¸å…³è¿˜æ˜¯ä¸æ™¯ç‚¹æ— å…³ã€‚

          - å¦‚æœæ˜¯å…³äºæ™¯ç‚¹ä¿¡æ¯å¤–çš„è¯¢é—®åˆ™å½’ä¸ºæ™¯ç‚¹æ— å…³ï¼Œä¾‹å¦‚å¤©æ°”æ¸©åº¦ç­‰ç­‰ï¼Œåªæ”¯æŒæ™¯ç‚¹è¯„ä»·ï¼Œä½ç½®ï¼Œå†…å®¹ç­‰ä¿¡æ¯


          # é™åˆ¶(Constraint)

          - åªèƒ½ç»™å‡ºâ€œæ™¯ç‚¹ç›¸å…³â€æˆ–â€œæ™¯ç‚¹æ— å…³â€è¿™ä¸¤ç§åˆ¤æ–­ç»“æœã€‚

          - ä¸èƒ½å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå…¶ä»–é¢å¤–è§£è¯»æˆ–è¯„è®ºã€‚


          # è¾“å‡º(Output)

          - è¾“å‡ºå†…å®¹ä¸ºâ€œæ™¯ç‚¹ç›¸å…³â€æˆ–â€œæ™¯ç‚¹æ— å…³â€ã€‚


          # æ ¼å¼(Format)

          - è¾“å‡ºç®€æ´æ˜äº†ï¼Œæ— å¤šä½™ä¿®é¥°ã€‚


          # æ£€æŸ¥(Check)

          - æ£€æŸ¥åˆ¤æ–­ç»“æœæ˜¯å¦ç¬¦åˆè¾“å…¥å†…å®¹çš„çœŸå®æ„å›¾ã€‚


          # ç¤ºä¾‹(Example)

          - è¾“å…¥ï¼šæ˜å¤©éƒ‘å·å¤©æ°”æ€ä¹ˆæ ·

          - è¾“å‡ºï¼šæ™¯ç‚¹æ—…æ¸¸æ— å…³


          # è¦æ±‚(Claim)

          - è¾“å‡ºè¯­è¨€ä¸ºä¸­æ–‡ã€‚

          - åˆ¤æ–­ç»“æœå¿…é¡»æ¸…æ™°æ˜ç¡®ã€‚ '
        instructions: ''
        model:
          completion_params:
            response_format: text
          mode: chat
          name: deepseek-v3
          provider: langgenius/tongyi/tongyi
        query_variable_selector:
        - '1742642596090'
        - input
        selected: false
        title: æ„å›¾åˆ†æ
        topics: []
        type: question-classifier
        vision:
          enabled: false
      height: 171
      id: '1742971822317'
      position:
        x: 334
        y: 285.5
      positionAbsolute:
        x: 334
        y: 285.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        error_handle_mode: continue-on-error
        height: 285
        is_parallel: true
        iterator_selector:
        - '1742895657263'
        - keywords
        output_selector:
        - '1743146801950'
        - output
        output_type: array[string]
        parallel_nums: 10
        selected: false
        start_node_id: 1743145179759start
        title: ç”¨æˆ·è¯„è®º
        type: iteration
        width: 996
      height: 285
      id: '1743145179759'
      position:
        x: 1550
        y: 817.0714285714286
      positionAbsolute:
        x: 1550
        y: 817.0714285714286
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 996
      zIndex: 1
    - data:
        desc: ''
        isInIteration: true
        selected: false
        title: ''
        type: iteration-start
      draggable: false
      height: 48
      id: 1743145179759start
      parentId: '1743145179759'
      position:
        x: 24
        y: 68
      positionAbsolute:
        x: 1574
        y: 885.0714285714286
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-iteration-start
      width: 44
      zIndex: 1002
    - data:
        code: "import json\nimport requests\n\n\ndef find_sight_data(data):\n    \"\
          \"\"åœ¨dataæ•°ç»„ä¸­æŸ¥æ‰¾typeä¸ºsightçš„æœ‰æ•ˆæ•°æ®\"\"\"\n    for item in data:\n        if isinstance(item,\
          \ dict) and item.get('type') == 'sight':\n            required_fields =\
          \ ['districtName', 'districtId', 'productId']\n            if all(item.get(field)\
          \ for field in required_fields):\n                return item\n    return\
          \ None\n\n\ndef main(keyword: str):\n    url = \"https://m.ctrip.com/restapi/soa2/30668/search\"\
          \n\n    querystring = {\n        \"action\": \"globalonline\",\n       \
          \ \"source\": \"globalonline\",\n        \"keyword\": keyword\n    }\n\n\
          \    payload = \"\"\n    headers = {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\
          ,\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\
          \ (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 Edg/134.0.0.0\",\n\
          \        \"Accept\": \"*/*\",\n        \"Accept-Encoding\": \"gzip, deflate,\
          \ br\",\n        \"Connection\": \"keep-alive\",\n        \"Cookie\": \"\
          GUID=09031022317999445208\",\n        \"Host\": \"m.ctrip.com\",\n     \
          \   \"Content-Length\": \"0\"\n    }\n\n    try:\n        response = requests.request(\"\
          POST\", url, data=payload, headers=headers, params=querystring)\n      \
          \  response.raise_for_status()\n\n        result = response.json()\n   \
          \     print(result['data'][0])\n        sight_data = find_sight_data(result.get('data',\
          \ []))\n\n        if not sight_data:\n            print(\"æœªæ‰¾åˆ°æœ‰æ•ˆçš„æ™¯åŒºæ•°æ®\")\n\
          \            return None\n\n        # ç”Ÿæˆæ‹¼éŸ³éƒ¨åˆ†\n        district_name = sight_data['eName']\
          \ if sight_data['eName'] else sight_data['districtName']\n        district_id\
          \ = sight_data['districtId']\n        product_id = sight_data['productId']\n\
          \n        # æŸ¥æ‰¾é¢å¤–ä¿¡æ¯\n        poi_id = str(sight_data['poiId'])\n\n      \
          \  # æ‹¼æ¥URL\n        ctrip_url = f\"https://you.ctrip.com/sight/{district_name}{district_id}/{product_id}.html\"\
          \n\n        search_result = {\n            'url': ctrip_url,\n         \
          \   'poi_id': poi_id,\n        }\n        return search_result\n\n    except\
          \ requests.exceptions.RequestException as e:\n        print(f\"è¯·æ±‚å¤±è´¥: {str(e)}\"\
          )\n    except json.JSONDecodeError:\n        print(\"å“åº”æ•°æ®è§£æå¤±è´¥\")\n    except\
          \ Exception as e:\n        print(f\"å¤„ç†å¼‚å¸¸: {str(e)}\")\n    return None"
        code_language: python3
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        outputs:
          poi_id:
            children: null
            type: string
          url:
            children: null
            type: string
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 1000
        selected: false
        title: æ™¯åŒºURLè·å–
        type: code
        variables:
        - value_selector:
          - '1743145179759'
          - item
          variable: keyword
      height: 79
      id: '1743145201728'
      parentId: '1743145179759'
      position:
        x: 128
        y: 68
      positionAbsolute:
        x: 1678
        y: 885.0714285714286
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "import json\nimport re\nimport requests\n\ndef main(url):\n    headers\
          \ = {\n        \"User-Agent\": \"PostmanRuntime-ApipostRuntime/1.1.0\",\n\
          \        \"Cookie\": \"_pd=%7B%22_o%22%3A70%2C%22s%22%3A1030%2C%22_s%22%3A9%7D;GUID=09031167317991829446\"\
          \n    }\n\n    response = requests.get(url, headers=headers)\n    if response.status_code\
          \ != 200:\n        return {'result_code': response.status_code, 'info':\
          \ {}}\n\n    # Part 1: ä½¿ç”¨æ­£åˆ™æå–JSONæ•°æ®\n    script_pattern = re.compile(r'<script\
          \ id=\"__NEXT_DATA__\".*?>(.*?)</script>', re.DOTALL)\n    script_match\
          \ = script_pattern.search(response.text)\n    \n    if not script_match:\n\
          \        return {'result_code': 404, 'info': {}}\n\n    json_data = json.loads(script_match.group(1))\n\
          \    poi_data = json_data[\"props\"][\"pageProps\"][\"initialState\"][\"\
          poiDetail\"]\n    \n    # Part 2: ä½¿ç”¨æ­£åˆ™æå–æ ‡ç­¾æ•°æ®\n    hot_tags_section = re.search(r'<div\
          \ class=\"hotTags\".*?>(.*?)</div>', response.text, re.DOTALL)\n    if not\
          \ hot_tags_section:\n        return {'result_code': 404, 'info': {}}\n\n\
          \    span_pattern = re.compile(r'<span.*?>(.*?)</span>')\n    spans = span_pattern.findall(hot_tags_section.group(1))\n\
          \n    def extract_number(text):\n        return int(re.search(r'\\d+', text).group())\
          \ if re.search(r'\\d+', text) else 0\n\n    return {\n        'info': {\n\
          \            'poi_id': int(poi_data[\"poiId\"]),\n            'poi_name':\
          \ str(poi_data[\"poiName\"]),\n            'comment_score': float(poi_data[\"\
          commentScore\"]),\n            'review_count': extract_number(spans[0])\
          \ if len(spans) >=1 else 0,\n            'positive': extract_number(spans[1])\
          \ if len(spans) >=2 else 0,\n            'negative': extract_number(spans[3])\
          \ if len(spans) >=4 else 0\n        }\n    }"
        code_language: python3
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        outputs:
          info:
            children: null
            type: object
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 1000
        selected: false
        title: æ™¯åŒºINFOè·å–
        type: code
        variables:
        - value_selector:
          - '1743145201728'
          - url
          variable: url
      height: 79
      id: '1743145790208'
      parentId: '1743145179759'
      position:
        x: 432
        y: 68
      positionAbsolute:
        x: 1982
        y: 885.0714285714286
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "import requests\nimport time\n\nimport uuid\n\n\ndef main(poi_id: int):\n\
          \    url = \"https://m.ctrip.com/restapi/soa2/13444/json/getCommentCollapseList\"\
          \n\n    user_contents = []\n\n    # å¾ªç¯1åˆ°10é¡µ\n    for page_index in range(1,\
          \ 4):\n        try:\n            payload = {\n                \"arg\": {\n\
          \                    \"channelType\": 2,\n                    \"collapseType\"\
          : 0,\n                    \"commentTagId\": 0,\n                    \"pageIndex\"\
          : page_index,  # åŠ¨æ€é¡µç \n                    \"pageSize\": 10,\n         \
          \           \"poiId\": poi_id,\n                    \"sourceType\": 1,\n\
          \                    \"sortType\": 3,\n                    \"starType\"\
          : 0,\n                    \"head\": {\n                        \"cid\":\
          \ str(uuid.uuid4())[:32],  # å»ºè®®åŠ¨æ€ç”Ÿæˆè®¾å¤‡ID\n                        \"ctok\"\
          : \"\",\n                        \"cver\": \"1.0\",\n                  \
          \      \"lang\": \"01\",\n                        \"sid\": \"8888\",\n \
          \                       \"syscode\": \"09\",\n                        \"\
          auth\": \"\",\n                        \"xsid\": \"\",\n               \
          \         \"extension\": []\n                    }\n                }\n\
          \            }\n\n            headers = {\n                \"User-Agent\"\
          : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36...\",\n\
          \                \"Content-Type\": \"application/json\",\n             \
          \   \"Cookie\": f\"GUID={str(uuid.uuid4()).replace('-', '')[:32]}\"  # åŠ¨æ€Cookie\n\
          \            }\n\n            response = requests.request(\"Post\", url,\
          \ json=payload, headers=headers)\n\n            # å¢åŠ çŠ¶æ€ç æ£€æŸ¥\n            if\
          \ response.status_code != 200:\n                print(f\"ç¬¬{page_index}é¡µè¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š{response.status_code}\"\
          )\n                continue\n\n            data = response.json()\n\n  \
          \          # å¤„ç†åˆ†é¡µç»ˆæ­¢æ¡ä»¶\n            if not data.get('result', {}).get('items'):\n\
          \                print(f\"ç¬¬{page_index}é¡µæ— æ•°æ®ï¼Œåœæ­¢çˆ¬å–\")\n                break\n\
          \n            # æå–è¯„è®ºå†…å®¹\n            user_contents.extend(\n            \
          \    [item['content'] for item in data['result']['items']]\n           \
          \ )\n\n            # æ·»åŠ éšæœºå»¶è¿Ÿé˜²æ­¢å°ç¦\n            time.sleep(1.5 + (page_index\
          \ % 3) * 0.5)\n\n        except Exception as e:\n            print(f\"ç¬¬{page_index}é¡µæŠ“å–å¼‚å¸¸ï¼š{str(e)}\"\
          )\n            continue\n\n    return {\n        'result': {\n         \
          \   'user_contents': user_contents\n        }\n    }\n"
        code_language: python3
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        outputs:
          result:
            children: null
            type: object
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 1000
        selected: false
        title: æ™¯åŒºCOMMENTSè·å–
        type: code
        variables:
        - value_selector:
          - '1743145201728'
          - poi_id
          variable: poi_id
      height: 79
      id: '1743145890624'
      parentId: '1743145179759'
      position:
        x: 432
        y: 186
      positionAbsolute:
        x: 1982
        y: 1003.0714285714286
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1743145179759'
        selected: false
        template: "{\r\n    \"sight\": {{ sight }},\r\n    \"info\": {{ info }},\r\
          \n    \"user_contents\": {{ result }}\r\n}"
        title: æ¨¡æ¿è½¬æ¢ 3
        type: template-transform
        variables:
        - value_selector:
          - '1743145790208'
          - info
          variable: info
        - value_selector:
          - '1743145890624'
          - result
          variable: result
        - value_selector:
          - '1743145179759'
          - item
          variable: sight
      height: 53
      id: '1743146801950'
      parentId: '1743145179759'
      position:
        x: 733.1428571428573
        y: 127.71428571428578
      positionAbsolute:
        x: 2283.1428571428573
        y: 944.7857142857143
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    viewport:
      x: -798.8639703016117
      y: -132.25755599622494
      zoom: 0.7000000000000002
